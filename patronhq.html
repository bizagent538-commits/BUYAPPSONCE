<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PatronHQ - Member & Donor Management</title>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}:root{--bg:#f8fafc;--card:#fff;--border:#e2e8f0;--text:#0f172a;--muted:#64748b;--primary:#8b5cf6;--success:#22c55e;--warning:#f59e0b;--danger:#ef4444;--gold:#eab308;--silver:#94a3b8;--bronze:#d97706}body{font-family:'Plus Jakarta Sans',sans-serif;background:var(--bg);color:var(--text)}.app{display:flex;min-height:100vh}.sidebar{width:220px;background:var(--card);border-right:1px solid var(--border);padding:20px;position:fixed;height:100vh}.logo{display:flex;align-items:center;gap:10px;margin-bottom:24px}.logo-icon{width:36px;height:36px;background:linear-gradient(135deg,var(--primary),#a855f7);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:18px}.logo-text{font-weight:700;font-size:18px}.nav-item{display:flex;align-items:center;gap:10px;padding:10px 14px;border-radius:8px;cursor:pointer;color:var(--muted);margin-bottom:4px;font-size:14px}.nav-item:hover,.nav-item.active{background:rgba(139,92,246,.1);color:var(--primary)}.main{flex:1;margin-left:220px;padding:24px}.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;flex-wrap:wrap;gap:12px}.title{font-size:22px;font-weight:700}.btn{padding:10px 18px;border-radius:8px;font-weight:600;cursor:pointer;border:none;font-family:inherit;font-size:14px}.btn-primary{background:var(--primary);color:white}.btn-secondary{background:white;border:1px solid var(--border)}.btn-danger{background:var(--danger);color:white}.btn-sm{padding:6px 12px;font-size:12px}.stats{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:20px}.stat-card{background:var(--card);border-radius:12px;padding:16px;border:1px solid var(--border)}.stat-label{font-size:11px;color:var(--muted);text-transform:uppercase;margin-bottom:6px}.stat-value{font-size:24px;font-weight:700}.card{background:var(--card);border-radius:12px;border:1px solid var(--border);overflow:hidden;margin-bottom:20px}.card-header{padding:14px 18px;border-bottom:1px solid var(--border);font-weight:600;display:flex;justify-content:space-between;align-items:center}.card-body{padding:16px}.table{width:100%;border-collapse:collapse}.table th,.table td{padding:12px 14px;text-align:left;border-bottom:1px solid var(--border);font-size:14px}.table th{background:var(--bg);font-weight:600;font-size:11px;text-transform:uppercase;color:var(--muted)}.view{display:none}.view.active{display:block}.badge{padding:4px 10px;border-radius:20px;font-size:11px;font-weight:600}.badge-platinum{background:linear-gradient(135deg,#e5e7eb,#d1d5db);color:#374151}.badge-gold{background:rgba(234,179,8,.15);color:var(--gold)}.badge-silver{background:rgba(148,163,184,.15);color:var(--silver)}.badge-bronze{background:rgba(217,119,6,.15);color:var(--bronze)}.badge-active{background:rgba(34,197,94,.15);color:var(--success)}.badge-expired{background:rgba(239,68,68,.15);color:var(--danger)}.tier-card{text-align:center;padding:20px;border-radius:12px;border:2px solid var(--border)}.tier-card.platinum{border-color:#9ca3af;background:linear-gradient(135deg,#f9fafb,#f3f4f6)}.tier-card.gold{border-color:var(--gold);background:rgba(234,179,8,.05)}.tier-card.silver{border-color:var(--silver);background:rgba(148,163,184,.05)}.tier-card.bronze{border-color:var(--bronze);background:rgba(217,119,6,.05)}.tier-count{font-size:32px;font-weight:700;margin:8px 0}.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;z-index:100}.modal-overlay.show{display:flex}.modal{background:var(--card);border-radius:16px;padding:24px;width:100%;max-width:500px;max-height:90vh;overflow-y:auto}.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.modal-title{font-size:18px;font-weight:700}.close-btn{background:none;border:none;font-size:24px;cursor:pointer;color:var(--muted)}.form-group{margin-bottom:14px}.form-label{display:block;font-size:13px;font-weight:500;margin-bottom:6px}.form-input,.form-select,.form-textarea{width:100%;padding:10px 12px;border-radius:8px;border:1px solid var(--border);font-size:14px;font-family:inherit}.form-textarea{min-height:80px;resize:vertical}.form-row{display:grid;grid-template-columns:1fr 1fr;gap:12px}.toast{position:fixed;bottom:20px;right:20px;background:#333;color:white;padding:12px 20px;border-radius:8px;z-index:200;display:none}.toast.show{display:block}@media(max-width:900px){.stats{grid-template-columns:repeat(2,1fr)}}@media(max-width:768px){.sidebar{display:none}.main{margin-left:0}}
  </style>
</head>
<body>
  <div class="app">
    <nav class="sidebar">
      <div class="logo"><div class="logo-icon">üèõÔ∏è</div><span class="logo-text">PatronHQ</span></div>
      <div class="nav-item active" onclick="showView('dashboard')">üìä Dashboard</div>
      <div class="nav-item" onclick="showView('members')">üë• Members</div>
      <div class="nav-item" onclick="showView('donors')">üíö Donors</div>
      <div class="nav-item" onclick="showView('donations')">üí∞ Donations</div>
      <div class="nav-item" onclick="showView('tiers')">üèÜ Tiers</div>
      <div class="nav-item" onclick="showView('receipts')">üßæ Receipts</div>
      <div class="nav-item" onclick="showView('settings')">‚öôÔ∏è Settings</div>
    </nav>
    <main class="main">
      <div id="view-dashboard" class="view active">
        <div class="header"><h1 class="title">Dashboard</h1><div style="display:flex;gap:10px"><button class="btn btn-secondary" onclick="openModal('donation')">+ Donation</button><button class="btn btn-primary" onclick="openModal('member')">+ Member</button></div></div>
        <div class="stats"><div class="stat-card"><div class="stat-label">Total Members</div><div class="stat-value" id="stat-members">0</div></div><div class="stat-card"><div class="stat-label">Active Donors</div><div class="stat-value" id="stat-donors">0</div></div><div class="stat-card"><div class="stat-label">YTD Donations</div><div class="stat-value" style="color:var(--primary)" id="stat-ytd">$0</div></div><div class="stat-card"><div class="stat-label">Avg Gift</div><div class="stat-value" id="stat-avg">$0</div></div></div>
        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:20px"><div class="tier-card platinum"><div>üèÜ Platinum</div><div class="tier-count" id="tier-platinum">0</div><div style="font-size:12px;color:var(--muted)">$10,000+</div></div><div class="tier-card gold"><div>ü•á Gold</div><div class="tier-count" id="tier-gold">0</div><div style="font-size:12px;color:var(--muted)">$5,000+</div></div><div class="tier-card silver"><div>ü•à Silver</div><div class="tier-count" id="tier-silver">0</div><div style="font-size:12px;color:var(--muted)">$1,000+</div></div><div class="tier-card bronze"><div>ü•â Bronze</div><div class="tier-count" id="tier-bronze">0</div><div style="font-size:12px;color:var(--muted)">$250+</div></div></div>
        <div class="card"><div class="card-header">Recent Activity</div><table class="table"><thead><tr><th>Date</th><th>Name</th><th>Type</th><th>Amount</th></tr></thead><tbody id="recent-activity"></tbody></table></div>
      </div>
      <div id="view-members" class="view"><div class="header"><h1 class="title">Members</h1><button class="btn btn-primary" onclick="openModal('member')">+ Add Member</button></div><div class="card"><table class="table"><thead><tr><th>Name</th><th>Email</th><th>Tier</th><th>Join Date</th><th>Status</th><th>Actions</th></tr></thead><tbody id="members-table"></tbody></table></div></div>
      <div id="view-donors" class="view"><div class="header"><h1 class="title">Donors</h1></div><div class="card"><table class="table"><thead><tr><th>Name</th><th>Email</th><th>Total Given</th><th>Tier</th><th>Last Gift</th></tr></thead><tbody id="donors-table"></tbody></table></div></div>
      <div id="view-donations" class="view"><div class="header"><h1 class="title">Donations</h1><button class="btn btn-primary" onclick="openModal('donation')">+ Record Donation</button></div><div class="card"><table class="table"><thead><tr><th>Date</th><th>Donor</th><th>Amount</th><th>Method</th><th>Receipt</th><th>Actions</th></tr></thead><tbody id="donations-table"></tbody></table></div></div>
      <div id="view-tiers" class="view"><div class="header"><h1 class="title">üèÜ Member Tiers</h1></div><div style="display:grid;grid-template-columns:repeat(2,1fr);gap:20px"><div class="card card-body"><h3 style="margin-bottom:12px">üèÜ Platinum ($10,000+)</h3><div id="list-platinum"></div></div><div class="card card-body"><h3 style="margin-bottom:12px">ü•á Gold ($5,000+)</h3><div id="list-gold"></div></div><div class="card card-body"><h3 style="margin-bottom:12px">ü•à Silver ($1,000+)</h3><div id="list-silver"></div></div><div class="card card-body"><h3 style="margin-bottom:12px">ü•â Bronze ($250+)</h3><div id="list-bronze"></div></div></div></div>
      <div id="view-receipts" class="view"><div class="header"><h1 class="title">üßæ Tax Receipts</h1></div><div class="card"><table class="table"><thead><tr><th>Date</th><th>Donor</th><th>Amount</th><th>Receipt #</th><th>Actions</th></tr></thead><tbody id="receipts-table"></tbody></table></div></div>
      <div id="view-settings" class="view"><div class="header"><h1 class="title">‚öôÔ∏è Settings</h1></div><div class="card card-body"><h3 style="margin-bottom:16px">Organization</h3><div class="form-group"><label class="form-label">Organization Name</label><input type="text" class="form-input" id="org-name" placeholder="Your Organization"></div><div class="form-group"><label class="form-label">Tax ID (EIN)</label><input type="text" class="form-input" id="org-ein" placeholder="XX-XXXXXXX"></div><button class="btn btn-primary" onclick="saveOrg()">Save</button></div><div class="card card-body"><h3 style="margin-bottom:16px">Data</h3><div style="display:flex;gap:12px"><button class="btn btn-secondary" onclick="exportData()">üì• Export</button><button class="btn btn-secondary" onclick="document.getElementById('import-file').click()">üì§ Import</button><button class="btn btn-danger" onclick="clearData()">üóëÔ∏è Clear</button><input type="file" id="import-file" accept=".json" style="display:none" onchange="importData(event)"></div></div></div>
    </main>
  </div>
  <div class="modal-overlay" id="modal-member"><div class="modal"><div class="modal-header"><h2 class="modal-title">Add Member</h2><button class="close-btn" onclick="closeModal('member')">&times;</button></div><form onsubmit="saveMember(event)"><div class="form-group"><label class="form-label">Name</label><input type="text" class="form-input" id="member-name" required></div><div class="form-row"><div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" id="member-email"></div><div class="form-group"><label class="form-label">Phone</label><input type="tel" class="form-input" id="member-phone"></div></div><div class="form-group"><label class="form-label">Address</label><textarea class="form-textarea" id="member-address"></textarea></div><div style="display:flex;gap:12px;margin-top:16px"><button type="button" class="btn btn-secondary" onclick="closeModal('member')">Cancel</button><button type="submit" class="btn btn-primary">Save</button></div></form></div></div>
  <div class="modal-overlay" id="modal-donation"><div class="modal"><div class="modal-header"><h2 class="modal-title">Record Donation</h2><button class="close-btn" onclick="closeModal('donation')">&times;</button></div><form onsubmit="saveDonation(event)"><div class="form-group"><label class="form-label">Donor</label><select class="form-select" id="donation-member" required></select></div><div class="form-row"><div class="form-group"><label class="form-label">Amount</label><input type="number" step="0.01" class="form-input" id="donation-amount" required></div><div class="form-group"><label class="form-label">Date</label><input type="date" class="form-input" id="donation-date" required></div></div><div class="form-group"><label class="form-label">Method</label><select class="form-select" id="donation-method"><option>Check</option><option>Card</option><option>Cash</option><option>Online</option><option>Stock</option></select></div><div class="form-group"><label class="form-label">Generate Receipt</label><select class="form-select" id="donation-receipt"><option value="yes">Yes</option><option value="no">No</option></select></div><div style="display:flex;gap:12px;margin-top:16px"><button type="button" class="btn btn-secondary" onclick="closeModal('donation')">Cancel</button><button type="submit" class="btn btn-primary">Save</button></div></form></div></div>
  <div class="toast" id="toast"></div>
  <script>
    let members=[{id:1,name:'John Smith',email:'john@email.com',phone:'555-0101',address:'123 Main St',joined:'2024-01-15',status:'active'},{id:2,name:'Mary Johnson',email:'mary@email.com',phone:'555-0102',address:'',joined:'2024-03-20',status:'active'},{id:3,name:'Bob Williams',email:'bob@email.com',phone:'',address:'',joined:'2025-06-01',status:'active'}];
    let donations=[{id:1,memberId:1,amount:5000,date:'2026-01-02',method:'Check',receipt:'R-2026-001'},{id:2,memberId:2,amount:2500,date:'2025-12-15',method:'Card',receipt:'R-2025-042'},{id:3,memberId:1,amount:5000,date:'2025-06-15',method:'Check',receipt:'R-2025-025'},{id:4,memberId:3,amount:500,date:'2025-11-20',method:'Online',receipt:'R-2025-038'}];
    let settings={orgName:'',ein:''};
    const SK='patronhq_data';
    function saveData(){try{localStorage.setItem(SK,JSON.stringify({members,donations,settings}));}catch(e){}}
    function loadData(){try{const s=localStorage.getItem(SK);if(s){const d=JSON.parse(s);if(d.members)members=d.members;if(d.donations)donations=d.donations;if(d.settings)settings=d.settings;}}catch(e){}}
    function getMember(id){return members.find(m=>m.id===id);}
    function fmt(n){return '$'+Number(n).toLocaleString();}
    function nextId(arr){return arr.length?Math.max(...arr.map(x=>x.id))+1:1;}
    function toast(msg){const t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),3000);}
    function getTier(total){if(total>=10000)return{name:'Platinum',class:'badge-platinum'};if(total>=5000)return{name:'Gold',class:'badge-gold'};if(total>=1000)return{name:'Silver',class:'badge-silver'};if(total>=250)return{name:'Bronze',class:'badge-bronze'};return{name:'-',class:''};}
    function getTotalGiven(memberId){return donations.filter(d=>d.memberId===memberId).reduce((s,d)=>s+Number(d.amount),0);}
    function showView(v){document.querySelectorAll('.view').forEach(el=>el.classList.remove('active'));document.querySelectorAll('.nav-item').forEach(el=>el.classList.remove('active'));document.getElementById('view-'+v).classList.add('active');event.target.classList.add('active');render();}
    function openModal(t){document.getElementById('modal-'+t).classList.add('show');if(t==='donation'){document.getElementById('donation-member').innerHTML='<option value="">Select...</option>'+members.map(m=>'<option value="'+m.id+'">'+m.name+'</option>').join('');document.getElementById('donation-date').value=new Date().toISOString().split('T')[0];}}
    function closeModal(t){document.getElementById('modal-'+t).classList.remove('show');}
    function saveMember(e){e.preventDefault();members.push({id:nextId(members),name:document.getElementById('member-name').value,email:document.getElementById('member-email').value,phone:document.getElementById('member-phone').value,address:document.getElementById('member-address').value,joined:new Date().toISOString().split('T')[0],status:'active'});saveData();closeModal('member');render();toast('Member added!');}
    function saveDonation(e){e.preventDefault();const receiptNo=document.getElementById('donation-receipt').value==='yes'?'R-'+new Date().getFullYear()+'-'+String(donations.length+1).padStart(3,'0'):'';donations.push({id:nextId(donations),memberId:Number(document.getElementById('donation-member').value),amount:Number(document.getElementById('donation-amount').value),date:document.getElementById('donation-date').value,method:document.getElementById('donation-method').value,receipt:receiptNo});saveData();closeModal('donation');render();toast('Donation recorded!');}
    function deleteMember(id){if(!confirm('Delete member?'))return;members=members.filter(m=>m.id!==id);donations=donations.filter(d=>d.memberId!==id);saveData();render();}
    function deleteDonation(id){if(!confirm('Delete?'))return;donations=donations.filter(d=>d.id!==id);saveData();render();}
    function saveOrg(){settings.orgName=document.getElementById('org-name').value;settings.ein=document.getElementById('org-ein').value;saveData();toast('Saved!');}
    function printReceipt(id){const d=donations.find(x=>x.id===id);if(!d)return;const m=getMember(d.memberId);const w=window.open('','','width=400,height=500');w.document.write('<html><head><title>Receipt</title></head><body style="font-family:sans-serif;padding:20px"><h2>'+(settings.orgName||'Organization')+'</h2><p>Tax ID: '+(settings.ein||'XX-XXXXXXX')+'</p><hr><p><strong>Receipt #:</strong> '+d.receipt+'</p><p><strong>Date:</strong> '+d.date+'</p><p><strong>Donor:</strong> '+(m?.name||'')+'</p><p><strong>Amount:</strong> '+fmt(d.amount)+'</p><hr><p style="font-size:12px">This receipt is for your tax records. No goods or services were provided in exchange for this contribution.</p></body></html>');w.print();}
    function render(){
      const ytd=donations.filter(d=>d.date.startsWith(new Date().getFullYear())).reduce((s,d)=>s+Number(d.amount),0);
      const avgGift=donations.length?Math.round(donations.reduce((s,d)=>s+Number(d.amount),0)/donations.length):0;
      const uniqueDonors=new Set(donations.map(d=>d.memberId)).size;
      document.getElementById('stat-members').textContent=members.length;
      document.getElementById('stat-donors').textContent=uniqueDonors;
      document.getElementById('stat-ytd').textContent=fmt(ytd);
      document.getElementById('stat-avg').textContent=fmt(avgGift);
      const tierCounts={platinum:0,gold:0,silver:0,bronze:0};
      members.forEach(m=>{const total=getTotalGiven(m.id);const tier=getTier(total);if(tier.name==='Platinum')tierCounts.platinum++;else if(tier.name==='Gold')tierCounts.gold++;else if(tier.name==='Silver')tierCounts.silver++;else if(tier.name==='Bronze')tierCounts.bronze++;});
      document.getElementById('tier-platinum').textContent=tierCounts.platinum;
      document.getElementById('tier-gold').textContent=tierCounts.gold;
      document.getElementById('tier-silver').textContent=tierCounts.silver;
      document.getElementById('tier-bronze').textContent=tierCounts.bronze;
      const recent=[...donations].sort((a,b)=>b.date.localeCompare(a.date)).slice(0,5);
      document.getElementById('recent-activity').innerHTML=recent.map(d=>{const m=getMember(d.memberId);return '<tr><td>'+d.date+'</td><td>'+(m?.name||'-')+'</td><td>Donation</td><td>'+fmt(d.amount)+'</td></tr>';}).join('')||'<tr><td colspan="4" style="text-align:center;color:var(--muted)">No activity</td></tr>';
      document.getElementById('members-table').innerHTML=members.map(m=>{const total=getTotalGiven(m.id);const tier=getTier(total);return '<tr><td>'+m.name+'</td><td>'+(m.email||'-')+'</td><td>'+(tier.name!=='-'?'<span class="badge '+tier.class+'">'+tier.name+'</span>':'-')+'</td><td>'+m.joined+'</td><td><span class="badge badge-active">'+m.status+'</span></td><td><button class="btn btn-sm btn-danger" onclick="deleteMember('+m.id+')">Del</button></td></tr>';}).join('');
      document.getElementById('donors-table').innerHTML=members.filter(m=>getTotalGiven(m.id)>0).sort((a,b)=>getTotalGiven(b.id)-getTotalGiven(a.id)).map(m=>{const total=getTotalGiven(m.id);const tier=getTier(total);const last=donations.filter(d=>d.memberId===m.id).sort((a,b)=>b.date.localeCompare(a.date))[0];return '<tr><td>'+m.name+'</td><td>'+(m.email||'-')+'</td><td>'+fmt(total)+'</td><td><span class="badge '+tier.class+'">'+tier.name+'</span></td><td>'+(last?.date||'-')+'</td></tr>';}).join('');
      document.getElementById('donations-table').innerHTML=[...donations].sort((a,b)=>b.date.localeCompare(a.date)).map(d=>{const m=getMember(d.memberId);return '<tr><td>'+d.date+'</td><td>'+(m?.name||'-')+'</td><td>'+fmt(d.amount)+'</td><td>'+d.method+'</td><td>'+(d.receipt||'-')+'</td><td><button class="btn btn-sm btn-danger" onclick="deleteDonation('+d.id+')">Del</button></td></tr>';}).join('');
      ['platinum','gold','silver','bronze'].forEach(tier=>{const tierMembers=members.filter(m=>{const t=getTier(getTotalGiven(m.id));return t.name.toLowerCase()===tier;});document.getElementById('list-'+tier).innerHTML=tierMembers.map(m=>'<div style="padding:8px 0;border-bottom:1px solid var(--border)">'+m.name+' - '+fmt(getTotalGiven(m.id))+'</div>').join('')||'<p style="color:var(--muted)">None</p>';});
      document.getElementById('receipts-table').innerHTML=donations.filter(d=>d.receipt).sort((a,b)=>b.date.localeCompare(a.date)).map(d=>{const m=getMember(d.memberId);return '<tr><td>'+d.date+'</td><td>'+(m?.name||'-')+'</td><td>'+fmt(d.amount)+'</td><td>'+d.receipt+'</td><td><button class="btn btn-sm btn-secondary" onclick="printReceipt('+d.id+')">Print</button></td></tr>';}).join('');
      document.getElementById('org-name').value=settings.orgName||'';
      document.getElementById('org-ein').value=settings.ein||'';
    }
    function exportData(){const data=JSON.stringify({members,donations,settings},null,2);const blob=new Blob([data],{type:'application/json'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='patronhq-backup.json';a.click();toast('Exported!');}
    function importData(e){const file=e.target.files[0];if(!file)return;const r=new FileReader();r.onload=function(ev){try{const data=JSON.parse(ev.target.result);if(data.members)members=data.members;if(data.donations)donations=data.donations;if(data.settings)settings=data.settings;saveData();render();toast('Imported!');}catch(err){alert('Invalid file');}};r.readAsText(file);e.target.value='';}
    function clearData(){if(!confirm('Delete ALL data?'))return;if(!confirm('Are you sure?'))return;members=[];donations=[];settings={orgName:'',ein:''};saveData();render();toast('Cleared');}
    document.addEventListener('DOMContentLoaded',function(){loadData();render();});
  </script>
</body>
</html>
